<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cartas Secretas ‚úâÔ∏è</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Caveat&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Caveat', cursive;
      background: linear-gradient(to bottom, #ffe3f1, #ffd3e3);
      color: #3a2c2c;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem;
    }

    header {
      text-align: center;
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 1rem;
      background-color: #ff69b4;
      color: white;
      width: 100%;
      padding: 1rem 0;
      border-radius: 1rem;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      max-width: 1200px;
      width: 100%;
    }

    aside, main {
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      padding: 1rem;
      flex: 1;
      min-width: 300px;
    }

    h2 {
      margin-bottom: 0.5rem;
      font-size: 1.6rem;
    }

    input, textarea, button {
      font-family: 'Caveat', cursive;
      font-size: 1.2rem;
      width: 100%;
      margin: 0.5rem 0;
      padding: 0.5rem;
      border: 2px solid #ff69b4;
      border-radius: 0.8rem;
    }

    button {
      background-color: #ff69b4;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:disabled {
      background-color: #ffa9d1;
      cursor: not-allowed;
    }

    .carta {
      background: #fff9fc;
      padding: 1rem;
      border-left: 5px solid #ff69b4;
      margin-bottom: 1rem;
      border-radius: 0.5rem;
      white-space: pre-wrap;
    }

    .sobre {
      width: 100px;
      height: 60px;
      background: #ffb6c1;
      margin: 1rem auto;
      border-radius: 5px 5px 15px 15px;
      position: relative;
    }

    .sobre::before, .sobre::after {
      content: '';
      position: absolute;
      width: 0;
      height: 0;
      border-style: solid;
    }

    .sobre::before {
      border-width: 30px 50px 0 50px;
      border-color: #ff69b4 transparent transparent transparent;
      top: 0;
      left: 0;
    }

    .bloqueo-msg {
      font-size: 0.9rem;
      color: #a8325a;
      margin-bottom: 0.3rem;
      min-height: 1rem;
    }

    .usuario {
      font-weight: bold;
      color: #c2185b;
    }

    .conectado {
      font-size: 0.95rem;
      color: #444;
      margin-bottom: 0.3rem;
    }

    .likes {
      color: #e91e63;
      cursor: pointer;
      font-size: 1.2rem;
      margin-top: 0.3rem;
    }

    .likes:hover {
      transform: scale(1.1);
    }
  </style>
</head>
<body>
  <header>Cartas Secretas ‚úâÔ∏è</header>

  <div class="container">
    <aside>
      <h2>Tu Perfil</h2>
      <input type="text" id="nombreUsuario" placeholder="Tu nombre" maxlength="20">
      <button id="btnBloquear">üîí Bloquear nombre</button>
      <div class="bloqueo-msg" id="msgBloqueo"></div>

      <h2>Usuarios conectados</h2>
      <div id="usuariosConectados"></div>
    </aside>

    <main>
      <div class="sobre"></div>

      <h2>Enviar una carta</h2>
      <input type="text" id="destinatario" placeholder="@usuario">
      <textarea id="mensaje" placeholder="Escrib√≠ tu mensaje..."></textarea>
      <button id="btnEnviar" disabled>Enviar carta</button>

      <h2>Cartas enviadas</h2>
      <div id="cartasContainer"></div>
    </main>
  </div>

  <script>
    const nombreInput = document.getElementById('nombreUsuario');
    const destinatarioInput = document.getElementById('destinatario');
    const mensajeInput = document.getElementById('mensaje');
    const btnEnviar = document.getElementById('btnEnviar');
    const cartasContainer = document.getElementById('cartasContainer');
    const usuariosConectados = document.getElementById('usuariosConectados');
    const btnBloquear = document.getElementById('btnBloquear');
    const msgBloqueo = document.getElementById('msgBloqueo');

    const LS_NOMBRE = 'nombreUsuario';
    const LS_FECHA_BLOQUEO = 'fechaBloqueo';
    const LS_CARTAS = 'cartas';
    const LS_BLOQUEADO = 'bloqueado';

    let nombreBloqueado = localStorage.getItem(LS_BLOQUEADO) === 'true';

    const usuarios = ['conejo', 'lucas', 'valentina', 'sofia', 'andres'];

    function cargarNombre() {
      const nombre = localStorage.getItem(LS_NOMBRE) || '';
      nombreInput.value = nombre;
    }

    function bloquearNombre() {
      const nombre = nombreInput.value.trim();
      if (!nombre) return alert('Pon√© tu nombre primero.');
      nombreBloqueado = true;
      localStorage.setItem(LS_NOMBRE, nombre);
      localStorage.setItem(LS_FECHA_BLOQUEO, new Date().toISOString());
      localStorage.setItem(LS_BLOQUEADO, 'true');
      actualizarBloqueo();
    }

    function actualizarBloqueo() {
      nombreInput.disabled = nombreBloqueado;
      btnEnviar.disabled = nombreBloqueado || !validarInputs();
      btnBloquear.textContent = nombreBloqueado ? 'üîì Desbloquear (en 7 d√≠as)' : 'üîí Bloquear nombre';
      if (nombreBloqueado) {
        const fecha = new Date(localStorage.getItem(LS_FECHA_BLOQUEO));
        const hoy = new Date();
        const diasPasados = Math.floor((hoy - fecha) / (1000 * 60 * 60 * 24));
        if (diasPasados >= 7) {
          nombreBloqueado = false;
          localStorage.setItem(LS_BLOQUEADO, 'false');
        } else {
          msgBloqueo.textContent = `Nombre bloqueado por ${7 - diasPasados} d√≠a(s).`;
        }
      } else {
        msgBloqueo.textContent = '';
      }
    }

    function mostrarUsuarios() {
      usuariosConectados.innerHTML = '';
      usuarios.forEach(u => {
        const div = document.createElement('div');
        div.className = 'conectado';
        div.textContent = `@${u}`;
        usuariosConectados.appendChild(div);
      });
    }

    function validarInputs() {
      return mensajeInput.value.trim() && destinatarioInput.value.trim() && nombreInput.value.trim();
    }

    function guardarCarta() {
      const remitente = nombreInput.value.trim();
      const destinatario = destinatarioInput.value.trim();
      const mensaje = mensajeInput.value.trim();

      const cartas = JSON.parse(localStorage.getItem(LS_CARTAS) || '[]');
      cartas.unshift({ remitente, destinatario, mensaje });
      localStorage.setItem(LS_CARTAS, JSON.stringify(cartas));
    }

    function renderizarCartas() {
      const cartas = JSON.parse(localStorage.getItem(LS_CARTAS) || '[]');
      cartasContainer.innerHTML = '';
      cartas.forEach(({ remitente, destinatario, mensaje }, i) => {
        const div = document.createElement('div');
        div.className = 'carta';
        div.innerHTML = `
          <div><span class="usuario">Para:</span> ${destinatario}</div>
          <div><span class="usuario">De:</span> ${remitente}</div>
          <p>${mensaje}</p>
        `;
        cartasContainer.appendChild(div);
      });
    }

    nombreInput.addEventListener('input', () => {
      btnEnviar.disabled = !validarInputs();
    });

    destinatarioInput.addEventListener('input', () => {
      btnEnviar.disabled = !validarInputs();
    });

    mensajeInput.addEventListener('input', () => {
      btnEnviar.disabled = !validarInputs();
    });

    btnEnviar.addEventListener('click', () => {
      guardarCarta();
      mensajeInput.value = '';
      destinatarioInput.value = '';
      renderizarCartas();
      btnEnviar.disabled = true;
    });

    btnBloquear.addEventListener('click', bloquearNombre);

    window.addEventListener('load', () => {
      cargarNombre();
      actualizarBloqueo();
      mostrarUsuarios();
      renderizarCartas();
    });
  </script>
</body>
</html>

